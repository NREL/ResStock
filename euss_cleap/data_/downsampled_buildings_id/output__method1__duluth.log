2024-11-06 16:11:57,156 - INFO - ---------------------------------------------------------
2024-11-06 16:11:57,157 - INFO - Downsampling buildstock for  duluth  using method 1
2024-11-06 16:11:57,158 - INFO - ---------------------------------------------------------
2024-11-06 16:11:57,161 - INFO - Creating n>=1000 buildlstock by downsampling from: bst_to_search (549999 samples) 
while matching the marginal distribution of 13 key HCs from: bst_to_match (184 samples), 
['Income', 'ASHRAE IECC Climate Zone 2004', 'State', 'Geometry Building Type RECS', 'Heating Fuel', 'HVAC Cooling Type', 'Tenure', 'Water Heater Fuel', 'Vintage ACS', 'Geometry Floor Area Bin', 'HVAC Heating Type', 'Federal Poverty Level', 'Vacancy Status']
2024-11-06 16:11:57,161 - INFO - 
2024-11-06 16:11:57,162 - INFO - 
---- Attempt 1: downsample using 13 key HCs: ----
2024-11-06 16:11:57,433 - INFO -    Located 1910 positively weighted rows in bst_to_search
2024-11-06 16:11:57,433 - INFO - 
 -> Step 2 : Weight Recalculation
Method 1A - normalizing to exact joint-prob from bst_to_match ...
2024-11-06 16:11:57,477 - INFO -    Downsampling FAILED with insufficient rows: Recalculation leads to 249 positively weighted samples 
retry by relaxing HC_to_search by removing: build_existing_model.vacancy_status...
2024-11-06 16:11:57,478 - INFO - 
---- Attempt 2: downsample using 12 key HCs: ----
2024-11-06 16:11:57,493 - INFO -    Located 1910 positively weighted rows in bst_to_search
2024-11-06 16:11:57,493 - INFO - 
 -> Step 2 : Weight Recalculation
Method 1A - normalizing to exact joint-prob from bst_to_match ...
2024-11-06 16:11:57,526 - INFO -    Downsampling FAILED with insufficient rows: Recalculation leads to 249 positively weighted samples 
retry by relaxing HC_to_search by removing: build_existing_model.federal_poverty_level...
2024-11-06 16:11:57,527 - INFO - 
---- Attempt 3: downsample using 11 key HCs: ----
2024-11-06 16:11:57,537 - INFO -    Located 1910 positively weighted rows in bst_to_search
2024-11-06 16:11:57,537 - INFO - 
 -> Step 2 : Weight Recalculation
Method 1A - normalizing to exact joint-prob from bst_to_match ...
2024-11-06 16:11:57,573 - INFO -    Downsampling FAILED with insufficient rows: Recalculation leads to 282 positively weighted samples 
retry by relaxing HC_to_search by removing: build_existing_model.hvac_heating_type...
2024-11-06 16:11:57,574 - INFO - 
---- Attempt 4: downsample using 10 key HCs: ----
2024-11-06 16:11:57,586 - INFO -    Located 1910 positively weighted rows in bst_to_search
2024-11-06 16:11:57,586 - INFO - 
 -> Step 2 : Weight Recalculation
Method 1A - normalizing to exact joint-prob from bst_to_match ...
2024-11-06 16:11:57,617 - INFO -    Downsampling FAILED with insufficient rows: Recalculation leads to 286 positively weighted samples 
retry by relaxing HC_to_search by removing: build_existing_model.geometry_floor_area_bin...
2024-11-06 16:11:57,617 - INFO - 
---- Attempt 5: downsample using 9 key HCs: ----
2024-11-06 16:11:57,632 - INFO -    Located 1910 positively weighted rows in bst_to_search
2024-11-06 16:11:57,634 - INFO - 
 -> Step 2 : Weight Recalculation
Method 1A - normalizing to exact joint-prob from bst_to_match ...
2024-11-06 16:11:57,658 - INFO -    Downsampling FAILED with insufficient rows: Recalculation leads to 384 positively weighted samples 
retry by relaxing HC_to_search by removing: build_existing_model.vintage_acs...
2024-11-06 16:11:57,659 - INFO - 
---- Attempt 6: downsample using 8 key HCs: ----
2024-11-06 16:11:57,666 - INFO -    Located 1910 positively weighted rows in bst_to_search
2024-11-06 16:11:57,667 - INFO - 
 -> Step 2 : Weight Recalculation
Method 1A - normalizing to exact joint-prob from bst_to_match ...
2024-11-06 16:11:57,689 - INFO -    Downsampling FAILED with insufficient rows: Recalculation leads to 802 positively weighted samples 
retry by relaxing HC_to_search by removing: build_existing_model.water_heater_fuel...
2024-11-06 16:11:57,690 - INFO - 
---- Attempt 7: downsample using 7 key HCs: ----
2024-11-06 16:11:57,698 - INFO -    Located 1910 positively weighted rows in bst_to_search
2024-11-06 16:11:57,698 - INFO - 
 -> Step 2 : Weight Recalculation
Method 1A - normalizing to exact joint-prob from bst_to_match ...
2024-11-06 16:11:57,719 - INFO -    Downsampling FAILED with insufficient rows: Recalculation leads to 898 positively weighted samples 
retry by relaxing HC_to_search by removing: build_existing_model.tenure...
2024-11-06 16:11:57,720 - INFO - 
---- Attempt 8: downsample using 6 key HCs: ----
2024-11-06 16:11:57,726 - INFO -    Located 1910 positively weighted rows in bst_to_search
2024-11-06 16:11:57,727 - INFO - 
 -> Step 2 : Weight Recalculation
Method 1A - normalizing to exact joint-prob from bst_to_match ...
2024-11-06 16:11:57,751 - INFO -    Downsampling FAILED with insufficient rows: Recalculation leads to 947 positively weighted samples 
retry by relaxing HC_to_search by removing: build_existing_model.hvac_cooling_type...
2024-11-06 16:11:57,752 - INFO - 
---- Attempt 9: downsample using 5 key HCs: ----
2024-11-06 16:11:57,758 - INFO -    Located 1910 positively weighted rows in bst_to_search
2024-11-06 16:11:57,758 - INFO - 
 -> Step 2 : Weight Recalculation
Method 1A - normalizing to exact joint-prob from bst_to_match ...
2024-11-06 16:11:57,774 - INFO - 

** Downsampled to: 1177 samples, by matching to: ['build_existing_model.income', 'build_existing_model.ashrae_iecc_climate_zone_2004', 'build_existing_model.state', 'build_existing_model.geometry_building_type_recs', 'build_existing_model.heating_fuel']
2024-11-06 16:11:57,775 - INFO - 
 -> Step 3 : Weight Normalization
2024-11-06 16:11:57,778 - INFO - Checking marginals from weight_map of n=1177...
2024-11-06 16:11:57,785 - INFO -  [[ build_existing_model.income ]] 
2024-11-06 16:11:57,794 - INFO - 
                              matched     truth  pct_diff
build_existing_model.income                              
10000-14999                  0.048913  0.048913      -0.0
100000-119999                0.048913  0.048913       0.0
120000-139999                0.043478  0.043478       0.0
140000-159999                0.027174  0.027174       0.0
15000-19999                  0.048913  0.048913       0.0
160000-179999                0.010870  0.010870      -0.0
180000-199999                0.016304  0.016304       0.0
20000-24999                  0.076087  0.076087      -0.0
200000+                      0.043478  0.043478       0.0
25000-29999                  0.043478  0.043478      -0.0
30000-34999                  0.038043  0.038043      -0.0
35000-39999                  0.038043  0.038043      -0.0
40000-44999                  0.048913  0.048913      -0.0
45000-49999                  0.027174  0.027174       0.0
50000-59999                  0.086957  0.086957       0.0
60000-69999                  0.076087  0.076087      -0.0
70000-79999                  0.038043  0.038043      -0.0
80000-99999                  0.114130  0.114130       0.0
<10000                       0.065217  0.065217       0.0
Not Available                0.059783  0.059783      -0.0

2024-11-06 16:11:57,802 - INFO -  [[ build_existing_model.ashrae_iecc_climate_zone_2004 ]] 
2024-11-06 16:11:57,814 - INFO - 
                                                    matched  truth  pct_diff
build_existing_model.ashrae_iecc_climate_zone_2004                          
7A                                                      1.0    1.0       0.0

2024-11-06 16:11:57,820 - INFO -  [[ build_existing_model.state ]] 
2024-11-06 16:11:57,827 - INFO - 
                            matched  truth  pct_diff
build_existing_model.state                          
MN                              1.0    1.0       0.0

2024-11-06 16:11:57,834 - INFO -  [[ build_existing_model.geometry_building_type_recs ]] 
2024-11-06 16:11:57,840 - INFO - 
                                                   matched     truth  pct_diff
build_existing_model.geometry_building_type_recs                              
Mobile Home                                       0.032609  0.032609       0.0
Multi-Family with 2 - 4 Units                     0.125000  0.125000      -0.0
Multi-Family with 5+ Units                        0.184783  0.184783       0.0
Single-Family Attached                            0.027174  0.027174       0.0
Single-Family Detached                            0.630435  0.630435       0.0

2024-11-06 16:11:57,847 - INFO -  [[ build_existing_model.heating_fuel ]] 
2024-11-06 16:11:57,853 - INFO - 
                                    matched     truth  pct_diff
build_existing_model.heating_fuel                              
Electricity                        0.190217  0.190217       0.0
Fuel Oil                           0.054348  0.054348       0.0
Natural Gas                        0.695652  0.695652       0.0
None                               0.010870  0.010870       0.0
Other Fuel                         0.010870  0.010870       0.0
Propane                            0.038043  0.038043       0.0

2024-11-06 16:11:57,854 - INFO - For unmatched HC:
2024-11-06 16:11:57,854 - INFO - Checking marginals from weight_map of n=1177...
2024-11-06 16:11:57,862 - INFO -  [[ build_existing_model.hvac_cooling_type ]] 
2024-11-06 16:11:57,868 - INFO - 
                                         matched     truth   pct_diff
build_existing_model.hvac_cooling_type                               
Central AC                              0.682567  0.657609   3.795288
Ducted Heat Pump                        0.034823  0.038043  -8.465397
None                                    0.052950  0.043478  21.784238
Room AC                                 0.229661  0.260870 -11.963458

2024-11-06 16:11:57,876 - INFO -  [[ build_existing_model.tenure ]] 
2024-11-06 16:11:57,882 - INFO - 
                              matched     truth  pct_diff
build_existing_model.tenure                              
Not Available                0.059783  0.059783 -0.000000
Owner                        0.610839  0.597826  2.176707
Renter                       0.329378  0.342391 -3.800599

2024-11-06 16:11:57,889 - INFO -  [[ build_existing_model.water_heater_fuel ]] 
2024-11-06 16:11:57,894 - INFO - 
                                        matched     truth   pct_diff
build_existing_model.water_heater_fuel                              
Electricity                             0.35912  0.353261   1.658496
Natural Gas                             0.62157  0.635870  -2.248848
Propane                                 0.01931  0.010870  77.656501

2024-11-06 16:11:57,901 - INFO -  [[ build_existing_model.vintage_acs ]] 
2024-11-06 16:11:57,908 - INFO - 
                                   matched     truth    pct_diff
build_existing_model.vintage_acs                                
1940-59                           0.156822  0.201087  -22.012610
1960-79                           0.249136  0.163043   52.803348
1980-99                           0.180830  0.125000   44.663902
2000-09                           0.124613  0.092391   34.875588
2010s                             0.038316  0.010870  252.507707
<1940                             0.250282  0.407609  -38.597387

2024-11-06 16:11:57,915 - INFO -  [[ build_existing_model.geometry_floor_area_bin ]] 
2024-11-06 16:11:57,921 - INFO - 
                                               matched     truth   pct_diff
build_existing_model.geometry_floor_area_bin                               
0-1499                                        0.523022  0.586957 -10.892499
1500-2499                                     0.289894  0.271739   6.681132
2500-3999                                     0.169364  0.125000  35.491369
4000+                                         0.017719  0.016304   8.677268

2024-11-06 16:11:57,927 - INFO -  [[ build_existing_model.hvac_heating_type ]] 
2024-11-06 16:11:57,934 - INFO - 
                                         matched     truth   pct_diff
build_existing_model.hvac_heating_type                               
Ducted Heat Pump                        0.034823  0.038043  -8.465397
Ducted Heating                          0.755167  0.722826   4.474238
Non-Ducted Heating                      0.199140  0.228261 -12.757520
None                                    0.010870  0.010870  -0.000000

2024-11-06 16:11:57,941 - INFO -  [[ build_existing_model.federal_poverty_level ]] 
2024-11-06 16:11:57,946 - INFO - 
                                             matched     truth   pct_diff
build_existing_model.federal_poverty_level                               
0-100%                                      0.121637  0.119565   1.732858
100-150%                                    0.085545  0.081522   4.934590
150-200%                                    0.108826  0.130435 -16.566985
200-300%                                    0.163882  0.163043   0.514000
300-400%                                    0.152703  0.141304   8.066761
400%+                                       0.307626  0.304348   1.076967
Not Available                               0.059783  0.059783  -0.000000

2024-11-06 16:11:57,953 - INFO -  [[ build_existing_model.vacancy_status ]] 
2024-11-06 16:11:57,959 - INFO - 
                                      matched     truth  pct_diff
build_existing_model.vacancy_status                              
Occupied                             0.940217  0.940217       0.0
Vacant                               0.059783  0.059783      -0.0

2024-11-06 16:11:57,971 - INFO - truth vs. matched - per dwelling unit energy:
2024-11-06 16:11:57,978 - INFO - 
                                     matched       truth   pct_diff
energy_use_total_m_btu            163.050812  163.746658  -0.424952
fuel_use_electricity_total_m_btu   38.503421   38.645402  -0.367394
fuel_use_fuel_oil_total_m_btu       8.441916    8.036076   5.050222
fuel_use_natural_gas_total_m_btu  108.091325  107.658793   0.401761
fuel_use_propane_total_m_btu        6.578687    8.156701 -19.346234

2024-11-06 16:11:58,003 - INFO - truth vs. matched - per dwelling unit energy:
2024-11-06 16:11:58,010 - INFO - 
                                                                         matched       truth    pct_diff
build_existing_model.vacancy_status                                                                     
Occupied                            energy_use_total_m_btu            169.620547  170.289792   -0.393003
                                    fuel_use_electricity_total_m_btu   40.342269   40.533150   -0.470927
                                    fuel_use_fuel_oil_total_m_btu       8.161517    8.154624    0.084519
                                    fuel_use_natural_gas_total_m_btu  113.017392  112.563809    0.402956
                                    fuel_use_propane_total_m_btu        6.572637    7.709058  -14.741375
Vacant                              energy_use_total_m_btu             59.726794   60.841000   -1.831341
                                    fuel_use_electricity_total_m_btu    9.583369    8.956273    7.001756
                                    fuel_use_fuel_oil_total_m_btu      12.851832    6.171636  108.240261
                                    fuel_use_natural_gas_total_m_btu   30.617719   30.516273    0.332433
                                    fuel_use_propane_total_m_btu        6.673836   15.196909  -56.084257

2024-11-06 16:11:58,035 - INFO - truth vs. matched - per dwelling unit energy:
2024-11-06 16:11:58,045 - INFO - 
                                                                 matched       truth    pct_diff
build_existing_model.tenure                                                                     
Not Available               energy_use_total_m_btu             59.726794   60.841000   -1.831341
                            fuel_use_electricity_total_m_btu    9.583369    8.956273    7.001756
                            fuel_use_fuel_oil_total_m_btu      12.851832    6.171636  108.240261
                            fuel_use_natural_gas_total_m_btu   30.617719   30.516273    0.332433
                            fuel_use_propane_total_m_btu        6.673836   15.196909  -56.084257
Owner                       energy_use_total_m_btu            209.989892  209.988500    0.000663
                            fuel_use_electricity_total_m_btu   44.094476   44.349509   -0.575053
                            fuel_use_fuel_oil_total_m_btu      11.174861    8.878582   25.863131
                            fuel_use_natural_gas_total_m_btu  142.919153  143.163527   -0.170696
                            fuel_use_propane_total_m_btu        9.828829   11.892100  -17.349928
Renter                      energy_use_total_m_btu             94.754766  100.974587   -6.159789
                            fuel_use_electricity_total_m_btu   33.383723   33.869667   -1.434746
                            fuel_use_fuel_oil_total_m_btu       2.573207    6.890571  -62.656119
                            fuel_use_natural_gas_total_m_btu   57.563959   59.135730   -2.657905
                            fuel_use_propane_total_m_btu        0.533961    0.405333   31.733676

2024-11-06 16:11:58,079 - INFO - truth vs. matched - per dwelling unit energy:
2024-11-06 16:11:58,093 - INFO - 
                                                                                matched       truth    pct_diff
build_existing_model.federal_poverty_level                                                                     
0-100%                                     energy_use_total_m_btu            113.523053  131.273636  -13.521819
                                           fuel_use_electricity_total_m_btu   32.866670   34.287864   -4.144888
                                           fuel_use_fuel_oil_total_m_btu       1.643922    6.689636  -75.425835
                                           fuel_use_natural_gas_total_m_btu   77.116927   88.367864  -12.731932
                                           fuel_use_propane_total_m_btu        0.000000    0.000000         NaN
100-150%                                   energy_use_total_m_btu            131.922064  117.505133   12.269192
                                           fuel_use_electricity_total_m_btu   36.706046   44.032067  -16.637922
                                           fuel_use_fuel_oil_total_m_btu       6.057361    0.000000         inf
                                           fuel_use_natural_gas_total_m_btu   87.722053   73.473133   19.393374
                                           fuel_use_propane_total_m_btu        1.436678    0.000000         inf
150-200%                                   energy_use_total_m_btu            149.314517  145.398667    2.693182
                                           fuel_use_electricity_total_m_btu   37.697595   40.910417   -7.853310
                                           fuel_use_fuel_oil_total_m_btu       2.809934    0.000000         inf
                                           fuel_use_natural_gas_total_m_btu  102.625901   85.407833   20.159823
                                           fuel_use_propane_total_m_btu        6.181073   19.080375  -67.605075
200-300%                                   energy_use_total_m_btu            164.431017  179.507133   -8.398617
                                           fuel_use_electricity_total_m_btu   36.717469   33.198000   10.601450
                                           fuel_use_fuel_oil_total_m_btu      10.424538    9.564467    8.992359
                                           fuel_use_natural_gas_total_m_btu  109.183540  129.568733  -15.733112
                                           fuel_use_propane_total_m_btu        4.851618    0.925233  424.366961
300-400%                                   energy_use_total_m_btu            174.392136  172.744346    0.953889
                                           fuel_use_electricity_total_m_btu   38.639770   30.372462   27.219751
                                           fuel_use_fuel_oil_total_m_btu      13.629038   17.973731  -24.172458
                                           fuel_use_natural_gas_total_m_btu  114.721711  119.235731   -3.785794
                                           fuel_use_propane_total_m_btu        3.003114    5.162462  -41.827873
400%+                                      energy_use_total_m_btu            209.864555  204.346464    2.700360
                                           fuel_use_electricity_total_m_btu   48.021058   50.534768   -4.974218
                                           fuel_use_fuel_oil_total_m_btu       9.297298    9.095125    2.222870
                                           fuel_use_natural_gas_total_m_btu  139.119287  131.970893    5.416645
                                           fuel_use_propane_total_m_btu       13.426950   12.745661    5.345264
Not Available                              energy_use_total_m_btu             59.726794   60.841000   -1.831341
                                           fuel_use_electricity_total_m_btu    9.583369    8.956273    7.001756
                                           fuel_use_fuel_oil_total_m_btu      12.851832    6.171636  108.240261
                                           fuel_use_natural_gas_total_m_btu   30.617719   30.516273    0.332433
                                           fuel_use_propane_total_m_btu        6.673836   15.196909  -56.084257

2024-11-06 16:11:58,106 - INFO - >> Database down-selected to 1177 buildings, based on input data of 184 buildings, result outputs to: 
C:\Users\ylou2\Desktop\resstock\euss_cleap\data_\downsampled_buildings_id\results_up00__downsampled_method1__duluth.csv

